# Project 7 - WordPress Pentesting

Time spent: **10** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS)
  - [ ] Summary: Admin's checks for comments are different than those for simple users. They can use HTML tags as part of their comment. Because of poor input sanitazation, an XSS can be sorted by an admin (or a malicious user that got their hand on the admin's credentials).
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.23
  - [ ] GIF Walkthrough: 
		<img src="vulnerability 1.gif" width="800">
  - [ ] Steps to recreate: inject "<_script_>confirm("XSS");</_script_>" into a comment while logged in. The script will be executed when the page is loaded.
  - [ ] Affected source code:
    - [Link 1](https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b)

2. WordPress 3.4-4.7 - Stored Cross-Site Scripting (XSS) via Theme Name fallback
  - [ ] Summary: An XSS attack is possible with a malicious scrpit inserted within a page template. This script can be unknowiling downloaded by an admin as part of a theme or plugin.
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.11
  - [ ] GIF Walkthrough: 
  		<img src="vulnerability 2.gif" width="800">
  - [ ] Steps to recreate: 
	- Go to Appearance > editor
	- Select a file without a name, for example back-compat.php.
   	- Add "/* Template Name: <_script_>confirm("Hello from the page template");</_script_> */" at the top of the file
    - The script will be executed each time a page is loaded.
  - [ ] Affected source code:
    - [Link 1](https://github.com/WordPress/WordPress/commit/ce7fb2934dd111e6353784852de8aea2a938b359)
3.  WordPress  4.0-4.7.2 - Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds
  - [ ] Summary: Contributor to a site (or a malicious user gaining access to the edit option) can inject PHP code using a youtube embeded link
    - Vulnerability types: XSS
    - Tested in version: 4.2
    - Fixed in version: 4.2.13
  - [ ] GIF Walkthrough:
 <img src="vulnerability 3.gif" width="800">
  - [ ] Steps to recreate: 
    - Log in
    - Edit a post with the following string: [embed src='https://youtube.com/embed/12345\x3csvg onload=alert("Hi")\x3e'][/embed]
    - The malicious script will be executed each time the page is loaded.
  - [ ] Affected source code:
    - [Link 1](https://github.com/WordPress/WordPress/commit/419c8d97ce8df7d5004ee0b566bc5e095f0a6ca8)
1. (Optional) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)
1. (Optional) Vulnerability Name or ID
  - [ ] Summary: 
    - Vulnerability types:
    - Tested in version:
    - Fixed in version: 
  - [ ] GIF Walkthrough: 
  - [ ] Steps to recreate: 
  - [ ] Affected source code:
    - [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php) 

## Assets

List any additional assets, such as scripts or files

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

The main challenge was the understand how to exploit the vulnerabilitites pointed out by VPScan. WP has a huge code base!

## License

    Copyright 2019 Isabelle Delmas

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
